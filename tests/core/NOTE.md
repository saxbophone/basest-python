NOTE TO SELF:

I think the bug for issue #19 is in best_ratio and NOT in encode_raw / decode_raw!
I think this is because best_ratio may not be intended to cater for ratios of bases that are from small to large
